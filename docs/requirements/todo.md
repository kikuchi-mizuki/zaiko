# 未確定事項

Phase1実装前に確認が必要な項目をまとめています。

---

## 優先度: 高（実装に必須）

### Excel関連

#### Excel列構成の確定
- [ ] 実際のExcelファイルサンプルの入手
- [ ] 列名の確定（商品名、ケース数、賞味期限、ロット番号など）
- [ ] 必須列とオプション列の明確化
- [ ] データ型の確認（数値、日付フォーマット）

!!! warning "影響範囲"
    Excel同期処理の実装全体に影響します。最優先で確定してください。

#### 現在のExcel保存場所の確認
- [ ] 加工会社の現在の運用方法
- [ ] Excelファイルの保存場所（ローカル/クラウド）
- [ ] 更新頻度（都度/日次/週次）
- [ ] 更新担当者

#### 商品名→product_id の照合ルール詳細
- [ ] Excelの商品名と、マスタの商品名が完全一致するか
- [ ] 表記ゆれがあるか（例: 「生チョコレート」vs「生チョコ」）
- [ ] SKUコードで照合する可能性があるか

---

### 納品書関連

#### 既存テンプレートファイルの入手
- [ ] 現在使用している納品書のExcel/PDFファイル
- [ ] レイアウト確認
- [ ] 必須項目の洗い出し

!!! info "代替案"
    既存テンプレートがない場合、新規で作成します。デザイン案を提示可能です。

#### 必須項目の確定
- [ ] 納品日
- [ ] 納品書番号
- [ ] 発注元（店舗名）
- [ ] 発注先（貴社名）
- [ ] 商品名
- [ ] 数量（ケース数/個数）
- [ ] ロット番号
- [ ] 賞味期限
- [ ] 配送業者・追跡番号
- [ ] その他（備考欄など）

#### 単価・金額の表示要否
- [ ] 単価を記載するか
- [ ] 小計・合計金額を記載するか
- [ ] 請求書としても使用するか（別途請求書を発行するか）

**単価を記載する場合**:
- `products` テーブルに `unit_price` カラム追加が必要

---

### マスタデータ

#### 商品マスタの初期データ
- [ ] 商品数（全体で何商品あるか）
- [ ] 商品一覧（商品名、ケースサイズ）
- [ ] SKUコードの有無
- [ ] 単価情報の有無
- [ ] 現在管理しているExcel/CSV等のファイル

!!! tip "データ投入方法"
    CSV形式で提供いただければ、一括インポート可能です。

#### 店舗マスタの初期データ
- [ ] 15店舗の一覧（店舗名）
- [ ] 店舗コード
- [ ] 配送先住所（納品書に記載する場合）

---

## 優先度: 中（仮決めで進行可能）

### 通知関連

#### 管理者LINEグループの作成
- [ ] 管理者用のLINEグループを作成
- [ ] グループIDの取得
- [ ] `system_settings` に登録

!!! note "グループID取得方法"
    LINE Official Account の Messaging API でグループIDを取得できます。セットアップ時にサポートします。

#### 加工会社への出荷依頼通知方法
- [ ] LINE通知
- [ ] メール通知
- [ ] 管理画面のみ（加工会社がログインして確認）

**推奨**: Phase1では管理画面のみ、Phase2でLINE/メール追加

---

### 権限・セキュリティ

#### 店舗マネージャー登録時の認証方法
- [ ] 誰でも友だち追加→店舗選択で登録可能（簡易）
- [ ] 事前に管理者が LINE ID を登録しておく（厳格）
- [ ] 招待コード方式（中間）

**現在の想定**: 誰でも友だち追加→店舗選択で登録可能

**リスク**: 間違った店舗を選択される可能性

**対策案**:
- 初回登録時に管理者に通知
- 管理者が承認するまで機能制限

#### 本部バイヤーの招待コード管理フロー
- [ ] 招待コードの発行方法（管理画面で発行）
- [ ] 有効期限（デフォルト: 7日間でOKか）
- [ ] 1回限り使用でOKか

---

### 加工会社の運用

#### 出荷完了報告の入力方法
- [ ] 管理画面で「出荷完了」ボタン + 追跡番号入力
- [ ] LINEで出荷完了報告
- [ ] CSV一括アップロード

**推奨**: 管理画面でボタン + 追跡番号入力

---

## 優先度: 低（Phase2以降）

### 納品一覧の出力

#### 出力形式
- [ ] CSV
- [ ] Excel
- [ ] Google Sheets

#### 出力タイミング
- [ ] 手動エクスポート（管理画面でボタンクリック）
- [ ] 自動エクスポート（日次/週次）

#### 出力内容
- [ ] 日次納品一覧（その日の出荷分）
- [ ] 店舗別納品一覧
- [ ] 商品別納品一覧

---

### ロット/賞味期限のFIFOルール

- [ ] 賞味期限の近い在庫から自動引当するか
- [ ] ロット番号を追跡するか
- [ ] 店舗に賞味期限を通知するか

---

### 納品日自動計算ロジック

!!! info "Phase1では実装しない"
    Phase1では納品日は表示せず、別途連絡します。

Phase3で実装する場合：

- [ ] 配送日数（店舗別）
- [ ] 祝日カレンダー
- [ ] 店舗の受入不可日（例: 火曜日は不可）
- [ ] 締切時間（例: 14時までの注文は翌日出荷）

---

## 確認方法

### ヒアリングの実施

以下の項目について、関係者へヒアリングを実施：

| 項目 | 確認先 | 期限 |
|------|--------|------|
| Excel列構成 | 加工会社 | Phase1開始前 |
| 納品書フォーマット | 本部/加工会社 | Phase1開始前 |
| 商品マスタ | 本部 | Phase1開始前 |
| 店舗マスタ | 本部 | Phase1開始前 |
| 加工会社の通知方法 | 加工会社 | Phase1開始後でも可 |

### ドキュメント共有

- [ ] ヒアリングシート作成
- [ ] 各担当者に共有
- [ ] 回答を本ドキュメントに反映

---

## 進捗管理

### チェックリスト

優先度:高の項目を全てチェックできたら、Phase1実装開始可能です。

**Excel関連**: ☐ 未完了 / ☑ 完了
**納品書関連**: ☐ 未完了 / ☑ 完了
**マスタデータ**: ☐ 未完了 / ☑ 完了

---

## 質問・相談窓口

不明点があれば、以下にご連絡ください：

- **GitHub Issues**: [https://github.com/kikuchi-mizuki/zaiko/issues](https://github.com/kikuchi-mizuki/zaiko/issues)
- **その他**: 本ドキュメントのコメント欄
