# LINE UI 設計

## リッチメニュー

### 店舗マネージャー向け

```
┌────────────────┬────────────────┐
│   在庫照会      │   追加発注     │
├────────────────┼────────────────┤
│  依頼状況確認   │   ヘルプ      │
└────────────────┴────────────────┘
```

### 本部バイヤー向け

```
┌────────────────┬────────────────┐
│  承認待ち一覧   │  全依頼確認    │
├────────────────┼────────────────┤
│  管理画面へ     │   ヘルプ      │
└────────────────┴────────────────┘
```

---

## 主要フロー

### 在庫照会フロー

```
店舗: [在庫照会] タップ

BOT: 商品を選択してください
     [生チョコレート]
     [トリュフ]
     [マカロン]
     ...

店舗: [生チョコレート] 選択

BOT: 【在庫照会結果】
     商品: 生チョコレート
     在庫: 10ケース
     ※この情報は2時間前のものです

     納品日は別途ご連絡します。
```

### 追加発注フロー

```
店舗: [追加発注] タップ

BOT: 商品を選択してください
     [生チョコレート]
     [トリュフ]
     [マカロン]
     ...

店舗: [生チョコレート] 選択

BOT: 数量（ケース数）を入力してください

店舗: 「10」と入力

BOT: 希望納品日はありますか？
     [できるだけ早く]
     [日付を指定]
     [特になし]

店舗: [できるだけ早く] 選択

BOT: 【確認】
     商品: 生チョコレート
     数量: 10ケース
     希望: できるだけ早く

     この内容で発注依頼しますか？
     [はい] [いいえ]

店舗: [はい]

BOT: 発注依頼を受け付けました。
     本部承認後、詳細をご連絡します。
```

### 本部承認フロー（LINE）

#### 承認依頼通知

```
BOT → 本部:
【承認依頼】
店舗: 高島屋新宿店
商品: 生チョコレート
数量: 10ケース
希望日: できるだけ早く

在庫: 10ケース（※2時間前）

[全量承認] [一部承認] [差戻し]
```

#### 一部承認の場合

```
本部: [一部承認] タップ

BOT: 承認する数量を入力してください

本部: 「7」と入力

BOT: 【確認】
     依頼数量: 10ケース
     承認数量: 7ケース
     保留数量: 3ケース

     7ケースを承認し、残り3ケースは在庫待ちとして登録します。
     よろしいですか？
     [はい] [いいえ]

本部: [はい]

BOT: 承認しました。
     店舗に通知し、出荷依頼を送信しました。
```

#### 店舗への一部承認通知

```
BOT → 店舗:
【一部承認】
依頼数量: 10ケース
承認数量: 7ケース
保留数量: 3ケース

7ケースは出荷手続きを進めます。
残り3ケースは在庫が確保でき次第、別途ご連絡します。

[了解] [残り3ケースをキャンセル]
```

#### 差戻しの場合

```
本部: [差戻し] タップ

BOT: 差戻し理由を入力してください

本部: 「商品の選択を間違えています」と入力

BOT: 差戻しました。店舗に通知します。
```

```
BOT → 店舗:
【差戻し】
商品: 生チョコレート
数量: 10ケース

理由: 商品の選択を間違えています

[修正して再依頼] [キャンセル]
```

### 依頼状況確認フロー

```
店舗: [依頼状況確認] タップ

BOT: 【現在の依頼状況】

     1. 生チョコレート 10ケース
        状態: 本部承認待ち
        依頼日: 2026/02/15

     2. トリュフ 5ケース
        状態: 出荷済み
        依頼日: 2026/02/10
        出荷日: 2026/02/13

     3. マカロン 8ケース
        状態: 一部承認（6ケース承認、2ケース保留）
        依頼日: 2026/02/14

     [詳細を見る] [閉じる]
```

---

## UI コンポーネント

### クイックリプライ
商品選択、希望納品日選択で使用

**特徴**:
- 最大13個まで表示可能
- タップで即座に選択完了

### Flex Message
承認依頼通知で使用

**特徴**:
- カード型のリッチなメッセージ
- ボタンを複数配置可能

### テキスト入力
数量入力、理由入力で使用

**バリデーション**:
- 数量: 整数チェック
- 理由: 最大200文字

---

## エラーメッセージ

### 入力エラー

```
BOT: 数量は整数で入力してください。
     例: 10
```

### システムエラー

```
BOT: システムエラーが発生しました。
     しばらく経ってから再度お試しください。

     エラーコード: ERR-001
```

### 権限エラー

```
BOT: この操作を行う権限がありません。
     管理者にお問い合わせください。
```

---

## 初回登録フロー

### 店舗マネージャー

```
店舗: LINE友だち追加

BOT: 初めてのご利用ですね。
     担当店舗を選択してください。

     [高島屋新宿店]
     [高島屋横浜店]
     [高島屋大阪店]
     ...

店舗: [高島屋新宿店] 選択

BOT: 登録が完了しました。
     下のメニューから操作できます。

     [在庫照会] [追加発注] [依頼状況確認] [ヘルプ]
```

### 本部バイヤー（招待コード）

```
本部: LINE友だち追加

BOT: 初めてのご利用ですね。
     招待コードを入力してください。

本部: 「BUYER-ABC123」と入力

BOT: 招待コードを確認しました。
     本部バイヤーとして登録が完了しました。

     [承認待ち一覧] [全依頼確認] [管理画面へ] [ヘルプ]
```

---

## 通知タイミング

### 店舗への通知
- 発注依頼受付完了
- 本部承認完了
- 一部承認完了（保留分の説明含む）
- 差戻し
- 出荷完了
- 仮引当期限切れ警告

### 本部への通知
- 新規発注依頼
- 店舗が修正再提出

### 管理者への通知
- Excel同期エラー
- 在庫引当失敗
- システムエラー
